edad <- c(
20, 23, 24, 25, 25, 26, 26, 28, 28, 29, 30, 30, 30, 30, 30, 30, 32, 32, 33, 33,
34, 34, 34, 34, 34, 35, 35, 36, 36, 36, 37, 37, 37, 38, 38, 39, 39, 40, 40, 41,
41, 42, 42, 42, 42, 43, 43, 43, 44, 44, 44, 44, 45, 45, 46, 46, 47, 47, 47, 48,
48, 48, 49, 49, 49, 50, 50, 51, 52, 52, 53, 53, 54, 55, 55, 55, 56, 56, 56, 57,
57, 57, 57, 57, 57, 58, 58, 58, 59, 59, 60, 60, 61, 62, 62, 63, 64, 64, 65, 69)
coro <- c(
0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,1,0,0,0,0,1,0,1,0,
0,0,0,0,1,0,0,1,0,0,1,1,0,1,0,1,0,0,1,0,1,1,0,0,1,0,1,0,0,1,1,1,1,0,1,1,1,1,1,0,
0,1,1,1,1,0,1,1,1,1,0,1,1,1,1,1,0,1,1,1)
# Gr?fica de los datos
edaj <- jitter(edad) # solo con fines de graficaci?on
plot(edaj, coro, xlab="Edad", ylab="Indicador CHD", ylim=c(-.1,1.1),
mgp=c(1.5,.5,0), cex.axis=.8, cex.lab=.8, cex.main=1, xlim=c(15,75), cex=.7,
main="Regresi?n lineal", pch=ifelse(coro==1,"1","0"))
rug(edaj)
out <- lm(coro ~ edad)
abline(reg=out$coef,lwd=2,col="blue")
plot(edaj, coro, xlab="Edad", ylab="Indicador CHD", ylim=c(-.1,1.1),
mgp=c(1.5,.5,0), cex.axis=.8, cex.lab=.8, cex.main=1, xlim=c(15,75), cex=.7,
main="Regresi?n Log?stica", pch=ifelse(coro==1,"1","0"))
rug(edaj)
# Resolviendo ecuaciones de verosimilitud
y <- coro
n <- length(y)
X <- cbind(rep(1,n),edad)
b <- c(-10,.2) # valores iniciales
# Las 4 l??neas anteriores son espec??ficas para los datos de coronaria
tolm <- 1e-6 # tolerancia (norma minima de delta)
iterm <- 100 # numero maximo de iteraciones
tolera <- 1 # inicializar tolera
itera <- 0 # inicializar itera
histo <- b # inicializar historial de iteraciones
while( (tolera>tolm)&(itera<iterm) ){
p <- 1/( 1+exp( -as.vector(X%*%b) ) )
W <- p*(1-p)
delta <- as.vector( solve(t(X*W)%*%X, t(X)%*%(y-p)) )
b <- b + delta
tolera <- sqrt( sum(delta*delta) )
histo <- rbind(histo,b)
itera <- itera + 1 }
# histo -10.000000 0.20000000
# b -1.497206 0.03767488
# b -4.380358 0.09253679
# b -5.221685 0.10918224
# b -5.308597 0.11090419
# b -5.309453 0.11092114
# b -5.309453 0.11092114
# Agregamos curva log??stica a la gr?afica original
xx <- seq(15,75,length=200)
X <- cbind(rep(1,n),xx)
p <- 1/( 1+exp( -as.vector(X%*%b) ) )
lines(xx,p,lwd=2,col="blue")
grid(lwd=2)
y <- coro
n <- length(y)
X <- cbind(rep(1,n),edad)
# Las l??neas anteriores son espec??ficas para los datos CHD
p <- 1/( 1+exp( -as.vector(X%*%b) ) )
W <- p*(1-p)
V <- solve( t(X*W)%*%X )
es <- sqrt( diag(V) )
# estimadores y sus desviaciones est?andar
# b es
# -5.3094534 1.13365464
# edad 0.1109211 0.02405984
# Usando glm
out <- glm(y ~ edad, family=binomial)
summary(out)
