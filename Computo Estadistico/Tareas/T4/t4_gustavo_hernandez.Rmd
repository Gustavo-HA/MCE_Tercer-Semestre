---
title: "T4 — Gustavo Hernández"
author: "Gustavo Hernández"
date: "`r format(Sys.Date(), '%d %B %Y')`"
output:
  pdf_document:
    toc: true
    number_sections: true
    latex_engine: xelatex
---

 
Generación de datos simulados y aplicación de los métodos de selección de subconjuntos.

\begin{enumerate}
  \item Usa una función en \texttt{R} para generar una variable predictora \texttt{X} de longitud 100, así como un vector de ruido \(\epsilon\) de longitud 100.
  \item Genera un vector de respuesta \texttt{Y} de longitud 100, de acuerdo al modelo
  \[
    Y = \beta_0 + \beta_1 X + \beta_2 X^2 + \beta_3 X^3 + \epsilon
  \]
  \item Utiliza la función \texttt{regsubsets()} para realizar la selección de subconjuntos con el fin de elegir el mejor modelo que contenga los predictores $\textbf{X}$, $\textbf{X}^2$, ..., $\textbf{X}^{10}$. ¿Qué modelo se selecciona como el mejor según el AIC, BIC y el $R^2$ ajustado? Muestra algunas gráficas que proporcionen evidencia de tu respuesta y reporta los coeficientes de mejor modelo obtenido.
  \item Repite (c) usando la selección forward stepwise y backward stepwise. ¿Cómo se compara tu respuesta con los resultados obtenidos en (c)?
\end{enumerate}

\textbf{Solución}

```{r}
    set.seed(123) # Para reproducibilidad
    n <- 100
    X <- runif(n, min=0, max=10) # Variable predictora
    epsilon <- rnorm(n, mean = 0, sd = 3) # Vector de ruido
```


```{r}
    beta_0 <- 5
    beta_1 <- 2
    beta_2 <- -3
    beta_3 <- 0.3
    Y <- beta_0 + beta_1 * X + beta_2 * X^2 + beta_3 * X^3 + epsilon
```

```{r}
  #scatterplot
  library(ggplot2)
  ggplot() +
    geom_point(mapping=aes(x=X,y=Y)) +
    theme_bw()
```


```{r}
    data <- data.frame(Y = Y)
    for (i in 1:10) {
        data[[paste0("X", i)]] <- X^i
    }
```

```{r}
library(leaps)
```

```{r}
options(max.print=10000)
```


```{r}
    regfit.full <- regsubsets(Y ~ ., data = data, nbest=252, really.big=T, nvmax=10)
    reg.summary <- summary(regfit.full)
    print(reg.summary)
```
```{r}
# Mejor subset segun bic
  bics = reg.summary$bic
  idx_menor = which.min(bics)
  cat(paste("Numero de variables: ", sum(reg.summary$which[idx_menor,]), "\n"))
  reg.summary$which[idx_menor,]
```

```{r}
# Mejor subset segun adjr2
  adjr2s = reg.summary$adjr2
  idx_menor = which.min(adjr2s)
  reg.summary$which[idx_menor,]
```

```{r}

plot(regfit.full, scale='adjr2')

```







